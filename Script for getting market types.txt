from selenium import *
from selenium import webdriver
import pandas as pd

links = ["https://www.londonstockexchange.com/stock/INL/inland-homes-plc/company-page",
         "https://www.londonstockexchange.com/stock/AZN/astrazeneca-plc/company-page",
         "https://www.udemy.com/"]

record = []
book = []
icounter = 0
found = False

PATH = "C:\Program Files (x86)\chromedriver.exe"
driver = webdriver.Chrome(PATH)

for i in links:

    driver.get(links[icounter])
    
    item = driver.find_elements_by_xpath("//*[contains(text(), 'Main Market')]")
    
    try:
        if isinstance(item, list):

            for element in item:
                book.append(element.text)
        else:
            book.append(element.text)
    except StaleElementReferenceException:
        pass
            
    if "Main Market" in book:
        found = True
        record.append("Main Market")
    
    book = []
    
    if "Main Market" not in book:
        item = driver.find_elements_by_xpath("//*[contains(text(), 'AIM')]")
        
        try:
            if isinstance(item, list):
                for element in item:
                    book.append(element.text)
            else:
                book.append(element.text)
        except StaleElementReferenceException:
            pass
        
        if "AIM" in book:
            found = True
            record.append("AIM")
    
    if found == False:
        record.append("Not found")

    ##    
    icounter += 1
    book = []
    found = False
driver.close()

df.to_excel("output_file.xlsx")